# CallHiss Troubleshooting Guide

## üîç Common Issues and Solutions

### 401 Unauthorized Error

**Symptoms:**
- Getting "401 Unauthorized" error when running CallHiss
- "Unable to fetch record" error
- Authentication failed messages

**Cause:**
This error occurs when your SignalWire credentials are incorrect, expired, or don't match your space.

**Solution:**

1. **Verify your credentials:**
   ```bash
   python verify_credentials.py
   ```

2. **Get correct credentials from SignalWire Dashboard:**
   - Go to [SignalWire Dashboard](https://signalwire.com/signin)
   - Select your space (e.g., "saorsadev")
   - Navigate to the **API** section
   - Copy the **Project ID** and **API Token**

3. **Update your config.env file:**
   ```bash
   # Edit config.env with correct values
   export SPACE_URL=your_space_name
   export PROJECT_ID=your_project_id_here
   export API_TOKEN=your_api_token_here
   export FROM_NUMBER=+1234567890
   ```

4. **Reload environment variables:**
   ```bash
   source config.env
   ```

5. **Test again:**
   ```bash
   python verify_credentials.py
   ```

### Common Credential Issues

#### Wrong Space URL
- **Problem:** Using incorrect space name
- **Fix:** Check your SignalWire dashboard URL. If it's `https://saorsadev.signalwire.com`, then `SPACE_URL=saorsadev`

#### Twilio Credentials
- **Problem:** Using Twilio credentials instead of SignalWire
- **Fix:** Make sure you're copying from SignalWire dashboard, not Twilio

#### Expired Token
- **Problem:** API token has been revoked or expired
- **Fix:** Generate a new API token in the SignalWire dashboard

#### Wrong Project
- **Problem:** Project ID doesn't exist in the specified space
- **Fix:** Verify the Project ID matches your space

### Phone Number Issues

**Error:** "FROM_NUMBER not found in your account"

**Solution:**
1. Run the verification tool to see available numbers:
   ```bash
   python verify_credentials.py
   ```
2. Update `FROM_NUMBER` in config.env to match one of your SignalWire numbers

### Webhook Issues

**Error:** "HTML Retrieval Error" or webhook timeouts

**Solutions:**
1. **Check ngrok is running:**
   ```bash
   ngrok http 3000
   ```

2. **Update HOST_APP with ngrok URL:**
   ```bash
   export HOST_APP=https://your-ngrok-url.ngrok.io
   ```

3. **Verify webhook is accessible:**
   ```bash
   curl https://your-ngrok-url.ngrok.io/ai-agent
   ```

### Network Issues

**Error:** Connection timeouts or network errors

**Solutions:**
1. **Check internet connection**
2. **Verify firewall settings** - ensure outbound HTTPS is allowed
3. **Test SignalWire connectivity:**
   ```bash
   curl https://saorsadev.signalwire.com
   ```

## üõ†Ô∏è Debugging Tools

### 1. Credential Verification
```bash
python verify_credentials.py
```
- Tests all credentials
- Shows available phone numbers
- Verifies account status

### 2. 401 Error Debugging
```bash
python debug_401.py
```
- Comprehensive authentication testing
- Tests multiple API endpoints
- Provides detailed error analysis

### 3. Fix 401 Issues
```bash
python fix_401_issue.py
```
- Guided troubleshooting for 401 errors
- Step-by-step fix instructions

## üìû Getting Help

If you're still experiencing issues:

1. **Check SignalWire Status:** [status.signalwire.com](https://status.signalwire.com)
2. **Contact SignalWire Support:** Include your Project ID and error details
3. **Community Forum:** [SignalWire Community](https://community.signalwire.com)

## üîß Quick Fix Checklist

- [ ] Environment variables are set (`source config.env`)
- [ ] Credentials are correct (run `python verify_credentials.py`)
- [ ] FROM_NUMBER exists in your account
- [ ] ngrok is running and HOST_APP is updated
- [ ] Internet connection is working
- [ ] SignalWire account is active

## üìã Environment Variables Reference

```bash
# Required
export SPACE_URL=your_space_name                    # Without .signalwire.com
export PROJECT_ID=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx
export API_TOKEN=PTxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
export FROM_NUMBER=+1234567890                      # Must be in your account

# Optional
export HOST_APP=https://your-ngrok-url.ngrok.io     # For webhooks
export PORT=3000                                     # Default: 3000
``` 